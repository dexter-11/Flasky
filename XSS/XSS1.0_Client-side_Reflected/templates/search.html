<!-- search.html -->
{% extends 'base.html' %}
{% block content %}
<h2>Book Search (Reflected XSS)</h2>
<form method="get">
  <label>Query</label>
  <input name="q" value="{{ request.args.get('q','') }}" placeholder="Try: <img src=x onerror=alert(1)>" />
  <button>Search</button>
</form>
<div class="spacer"></div>
{% if q_provided %}
  <div>
    You searched for: <strong>{{ q | safe }}</strong>
  </div>
  <div class="spacer"></div>
{% endif %}

{% if results is not none %}
  {% if results %}
    <ul>
    {% for b in results %}
      <li><strong>{{ b.title }}</strong> â€” {{ b.author }} ({{ b.year }})</li>
    {% endfor %}
    </ul>
  {% else %}
    <p>No results for <em>{{ q | safe }}</em>.</p>
  {% endif %}
{% endif %}

<p class="muted">Tip: Try injecting HTML/JS via the search box to observe reflected XSS behavior.</p>
{% endblock %}